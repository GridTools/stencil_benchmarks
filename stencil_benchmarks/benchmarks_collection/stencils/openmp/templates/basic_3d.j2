{% extends "base.j2" %}

{% block kernel_invoke %}
#pragma omp parallel for simd collapse(3)
{%- if streaming_stores %}
#ifdef __INTEL_COMPILER
#pragma vector nontemporal
#endif
{%- endif %}
    for (index_t i = 0; i < {{ sorted_domain[0] }}; ++i) {
        for (index_t j = 0; j < {{ sorted_domain[1] }}; ++j) {
            for (index_t k = 0; k < {{ sorted_domain[2] }}; ++k) {
                index_t index = i * {{ sorted_strides[0] }} + j * {{ sorted_strides[1] }} + k * {{ sorted_strides[2] }};
                {{ body }}
            }
        }
    }
{% endblock kernel_invoke %}
