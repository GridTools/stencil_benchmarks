{% extends "base.j2" %}

{% block kernel_invoke %}
    constexpr index_t last = {{ strides[0] }} * ({{ domain[0] }} - 1) +
                             {{ strides[1] }} * ({{ domain[1] }} - 1) +
                             {{ strides[2] }} * ({{ domain[2] }} - 1);

    #pragma omp parallel for simd
{%- if streaming_stores %}
    #ifdef __INTEL_COMPILER
    #pragma vector nontemporal
    #endif
{%- endif %}
    for (index_t index = 0; index <= last; ++index) {
        {{ body }}
    }
{% endblock kernel_invoke %}
